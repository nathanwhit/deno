/* esm.sh - esbuild bundle(postcss@8.4.31/lib/map-generator) esnext production */
import { Buffer as __Buffer$ } from "/v135/buffer@6.0.3/esnext/buffer.mjs";
import * as __0$ from "/v135/postcss@8.4.31/esnext/lib/input.js";
var require=n=>{const e=m=>typeof m.default<"u"?m.default:m,c=m=>Object.assign({},m);switch(n){case"postcss/lib/input":return e(__0$);default:throw new Error("module \""+n+"\" not found");}};
var q=Object.create;var u=Object.defineProperty;var k=Object.getOwnPropertyDescriptor;var j=Object.getOwnPropertyNames;var E=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty;var $=(i=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(i,{get:(t,e)=>(typeof require<"u"?require:t)[e]}):i)(function(i){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+i+'" is not supported')});var g=(i,t)=>()=>(i&&(t=i(i=0)),t);var D=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports),h=(i,t)=>{for(var e in t)u(i,e,{get:t[e],enumerable:!0})},p=(i,t,e,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of j(t))!T.call(i,s)&&s!==e&&u(i,s,{get:()=>t[s],enumerable:!(o=k(t,s))||o.enumerable});return i},a=(i,t,e)=>(p(i,t,"default"),e&&p(e,t,"default")),S=(i,t,e)=>(e=i!=null?q(E(i)):{},p(t||!i||!i.__esModule?u(e,"default",{value:i,enumerable:!0}):e,i)),d=i=>p(u({},"__esModule",{value:!0}),i);var w={};h(w,{default:()=>G});var G,y=g(()=>{G={}});var F={};h(F,{default:()=>H});var H,R=g(()=>{H={}});var b={};h(b,{default:()=>J});var J,x=g(()=>{J={}});var U=D((tt,B)=>{"use strict";var{SourceMapConsumer:z,SourceMapGenerator:m}=(y(),d(w)),{dirname:c,relative:A,resolve:I,sep:P}=(R(),d(F)),{pathToFileURL:L}=(x(),d(b)),K=$("postcss/lib/input"),N=!!(z&&m),Q=!!(c&&I&&A&&P),v=class{constructor(t,e,o,s){this.stringify=t,this.mapOpts=o.map||{},this.root=e,this.opts=o,this.css=s,this.usesFileUrls=!this.mapOpts.from&&this.mapOpts.absolute,this.memoizedFileURLs=new Map,this.memoizedPaths=new Map,this.memoizedURLs=new Map}addAnnotation(){let t;this.isInline()?t="data:application/json;base64,"+this.toBase64(this.map.toString()):typeof this.mapOpts.annotation=="string"?t=this.mapOpts.annotation:typeof this.mapOpts.annotation=="function"?t=this.mapOpts.annotation(this.opts.to,this.root):t=this.outputFile()+".map";let e=`
`;this.css.includes(`\r
`)&&(e=`\r
`),this.css+=e+"/*# sourceMappingURL="+t+" */"}applyPrevMaps(){for(let t of this.previous()){let e=this.toUrl(this.path(t.file)),o=t.root||c(t.file),s;this.mapOpts.sourcesContent===!1?(s=new z(t.text),s.sourcesContent&&(s.sourcesContent=s.sourcesContent.map(()=>null))):s=t.consumer(),this.map.applySourceMap(s,e,this.toUrl(this.path(o)))}}clearAnnotation(){if(this.mapOpts.annotation!==!1)if(this.root){let t;for(let e=this.root.nodes.length-1;e>=0;e--)t=this.root.nodes[e],t.type==="comment"&&t.text.indexOf("# sourceMappingURL=")===0&&this.root.removeChild(e)}else this.css&&(this.css=this.css.replace(/(\n)?\/\*#[\S\s]*?\*\/$/gm,""))}generate(){if(this.clearAnnotation(),Q&&N&&this.isMap())return this.generateMap();{let t="";return this.stringify(this.root,e=>{t+=e}),[t]}}generateMap(){if(this.root)this.generateString();else if(this.previous().length===1){let t=this.previous()[0].consumer();t.file=this.outputFile(),this.map=m.fromSourceMap(t)}else this.map=new m({file:this.outputFile()}),this.map.addMapping({generated:{column:0,line:1},original:{column:0,line:1},source:this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>"});return this.isSourcesContent()&&this.setSourcesContent(),this.root&&this.previous().length>0&&this.applyPrevMaps(),this.isAnnotation()&&this.addAnnotation(),this.isInline()?[this.css]:[this.css,this.map]}generateString(){this.css="",this.map=new m({file:this.outputFile()});let t=1,e=1,o="<no source>",s={generated:{column:0,line:0},original:{column:0,line:0},source:""},f,M;this.stringify(this.root,(l,r,O)=>{if(this.css+=l,r&&O!=="end"&&(s.generated.line=t,s.generated.column=e-1,r.source&&r.source.start?(s.source=this.sourcePath(r),s.original.line=r.source.start.line,s.original.column=r.source.start.column-1,this.map.addMapping(s)):(s.source=o,s.original.line=1,s.original.column=0,this.map.addMapping(s))),f=l.match(/\n/g),f?(t+=f.length,M=l.lastIndexOf(`
`),e=l.length-M):e+=l.length,r&&O!=="start"){let C=r.parent||{raws:{}};(!(r.type==="decl"||r.type==="atrule"&&!r.nodes)||r!==C.last||C.raws.semicolon)&&(r.source&&r.source.end?(s.source=this.sourcePath(r),s.original.line=r.source.end.line,s.original.column=r.source.end.column-1,s.generated.line=t,s.generated.column=e-2,this.map.addMapping(s)):(s.source=o,s.original.line=1,s.original.column=0,s.generated.line=t,s.generated.column=e-1,this.map.addMapping(s)))}})}isAnnotation(){return this.isInline()?!0:typeof this.mapOpts.annotation<"u"?this.mapOpts.annotation:this.previous().length?this.previous().some(t=>t.annotation):!0}isInline(){if(typeof this.mapOpts.inline<"u")return this.mapOpts.inline;let t=this.mapOpts.annotation;return typeof t<"u"&&t!==!0?!1:this.previous().length?this.previous().some(e=>e.inline):!0}isMap(){return typeof this.opts.map<"u"?!!this.opts.map:this.previous().length>0}isSourcesContent(){return typeof this.mapOpts.sourcesContent<"u"?this.mapOpts.sourcesContent:this.previous().length?this.previous().some(t=>t.withContent()):!0}outputFile(){return this.opts.to?this.path(this.opts.to):this.opts.from?this.path(this.opts.from):"to.css"}path(t){if(this.mapOpts.absolute||t.charCodeAt(0)===60||/^\w+:\/\//.test(t))return t;let e=this.memoizedPaths.get(t);if(e)return e;let o=this.opts.to?c(this.opts.to):".";typeof this.mapOpts.annotation=="string"&&(o=c(I(o,this.mapOpts.annotation)));let s=A(o,t);return this.memoizedPaths.set(t,s),s}previous(){if(!this.previousMaps)if(this.previousMaps=[],this.root)this.root.walk(t=>{if(t.source&&t.source.input.map){let e=t.source.input.map;this.previousMaps.includes(e)||this.previousMaps.push(e)}});else{let t=new K(this.css,this.opts);t.map&&this.previousMaps.push(t.map)}return this.previousMaps}setSourcesContent(){let t={};if(this.root)this.root.walk(e=>{if(e.source){let o=e.source.input.from;if(o&&!t[o]){t[o]=!0;let s=this.usesFileUrls?this.toFileUrl(o):this.toUrl(this.path(o));this.map.setSourceContent(s,e.source.input.css)}}});else if(this.css){let e=this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>";this.map.setSourceContent(e,this.css)}}sourcePath(t){return this.mapOpts.from?this.toUrl(this.mapOpts.from):this.usesFileUrls?this.toFileUrl(t.source.input.from):this.toUrl(this.path(t.source.input.from))}toBase64(t){return __Buffer$?__Buffer$.from(t).toString("base64"):window.btoa(unescape(encodeURIComponent(t)))}toFileUrl(t){let e=this.memoizedFileURLs.get(t);if(e)return e;if(L){let o=L(t).toString();return this.memoizedFileURLs.set(t,o),o}else throw new Error("`map.absolute` option is not available in this PostCSS build")}toUrl(t){let e=this.memoizedURLs.get(t);if(e)return e;P==="\\"&&(t=t.replace(/\\/g,"/"));let o=encodeURI(t).replace(/[#?]/g,encodeURIComponent);return this.memoizedURLs.set(t,o),o}};B.exports=v});var n={};h(n,{default:()=>X});var V=S(U());a(n,S(U()));var{default:_,...W}=V,X=_!==void 0?_:W;export{X as default};
//# sourceMappingURL=map-generator.js.map